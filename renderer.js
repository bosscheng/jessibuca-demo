!function(){function A(A){this.canvasElement=document.createElement("canvas"),this.canvasElement.style.position="absolute",this.canvasElement.style.top=0,this.canvasElement.style.left=0,A.container.appendChild(this.canvasElement),this.width=A.container.clientWidth,this.height=A.container.clientHeight,this.container=A.container,this.container.style.overflow="hidden",this.containerOldPostion={position:this.container.style.position,top:this.container.style.top,left:this.container.style.left,width:this.container.style.width,height:this.container.style.height},"absolute"!=this.containerOldPostion.position&&(this.container.style.position="relative"),this.contextOptions=A.contextOptions,this.videoBuffer=A.videoBuffer||0,this.text=A.text||"",this.isResize=!1!==A.isResize||A.isResize,A.forceNoGL||this.initContextGL(),this.audioContext=new(window.AudioContext||window.webkitAudioContext),this.audioEnabled(!0),A.isNotMute||this.audioEnabled(!1),this.contextGL&&(this.initProgram(),this.initBuffers(),this.initTextures()),this.onresize=(()=>this.resize()),this.onfullscreenchange=(()=>this.fullscreenchange()),window.addEventListener("resize",this.onresize),document.addEventListener("fullscreenchange",this.onfullscreenchange),this.decoderWorker=new Worker(A.decoder||"ff.js");var t=this;this.decoderWorker.onmessage=function(A){var e=A.data;switch(e.cmd){case"init":console.log("decoder worker init"),this.postMessage({cmd:"setVideoBuffer",time:t.videoBuffer}),t.onLoad&&(t.onLoad(),delete t.onLoad);break;case"initSize":t.canvasElement.width=e.w,t.canvasElement.height=e.h,t.resize(),console.log("video size:",e.w,e.h),t.isWebGL()||t.initRGB(e.w,e.h);break;case"render":t.contextGL?t.drawNextOuptutPictureGL(e.output):t.drawNextOuptutPictureRGBA(e.buffer),t.loading&&(t.loading=!1,t.onPlay()),t._updateBPS(e.bps),t._checkHeart();break;case"initAudio":t.initAudioPlay(e.frameCount,e.samplerate,e.channels);break;case"playAudio":t.playAudio(e.buffer);break;case"print":t.onLog&&t.onLog(e.text),console.log(e.text);break;case"printErr":t.onLog&&t.onLog(e.text),console.error(e.text);break;default:t[e.cmd](e)}},this.onPlay=e,this.onPause=e,this.onRecord=e,this.onFullscreen=e,this.doms=function(A,e){function t(A,e){Object.keys(e).forEach(function(t){A.style[t]=e[t]})}var i=document.createDocumentFragment(),n=document.createElement("div"),o=document.createElement("div"),r=document.createElement("div"),a=document.createElement("div"),s=document.createElement("div"),d=document.createElement("div"),c=document.createElement("div"),l=document.createElement("div"),h=document.createElement("div"),u=document.createElement("div"),g=document.createElement("div"),p=document.createElement("div"),m=document.createElement("div"),f=document.createElement("div"),E=document.createElement("div"),v=document.createElement("div"),B=document.createElement("div"),w=document.createElement("div");m.innerText=e.loadingText||"加载中......",a.innerText=e.text||"DB",s.innerText="",d.title="播放",l.title="暂停",h.title="截屏",u.title="全屏",g.title="退出全屏",f.title="静音",E.title="取消静音",v.title="录制",B.title="取消录制";var D={position:"absolute",width:"100%",height:"100%"};e.background&&(D=Object.assign({},D,{backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"100%",backgroundImage:"url('"+e.background+"')"}));var R={position:"absolute",width:"100%",height:"100%",textAlign:"center",color:"#fff",display:"none",backgroundImage:"url('data:image/gif;base64,R0lGODlhgACAAKIAAP///93d3bu7u5mZmQAA/wAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh+QQFBQAEACwCAAIAfAB8AAAD/0i63P4wygYqmDjrzbtflvWNZGliYXiubKuloivPLlzReD7al+7/Eh5wSFQIi8hHYBkwHUmD6CD5YTJLz49USuVYraRsZ7vtar7XnQ1Kjpoz6LRHvGlz35O4nEPP2O94EnpNc2sef1OBGIOFMId/inB6jSmPdpGScR19EoiYmZobnBCIiZ95k6KGGp6ni4wvqxilrqBfqo6skLW2YBmjDa28r6Eosp27w8Rov8ekycqoqUHODrTRvXsQwArC2NLF29UM19/LtxO5yJd4Au4CK7DUNxPebG4e7+8n8iv2WmQ66BtoYpo/dvfacBjIkITBE9DGlMvAsOIIZjIUAixliv9ixYZVtLUos5GjwI8gzc3iCGghypQqrbFsme8lwZgLZtIcYfNmTJ34WPTUZw5oRxdD9w0z6iOpO15MgTh1BTTJUKos39jE+o/KS64IFVmsFfYT0aU7capdy7at27dw48qdS7eu3bt480I02vUbX2F/JxYNDImw4GiGE/P9qbhxVpWOI/eFKtlNZbWXuzlmG1mv58+gQ4seTbq06dOoU6vGQZJy0FNlMcV+czhQ7SQmYd8eMhPs5BxVdfcGEtV3buDBXQ+fURxx8oM6MT9P+Fh6dOrH2zavc13u9JXVJb520Vp8dvC76wXMuN5Sepm/1WtkEZHDefnzR9Qvsd9+/wi8+en3X0ntYVcSdAE+UN4zs7ln24CaLagghIxBaGF8kFGoIYV+Ybghh841GIyI5ICIFoklJsigihmimJOLEbLYIYwxSgigiZ+8l2KB+Ml4oo/w8dijjcrouCORKwIpnJIjMnkkksalNeR4fuBIm5UEYImhIlsGCeWNNJphpJdSTlkml1jWeOY6TnaRpppUctcmFW9mGSaZceYopH9zkjnjUe59iR5pdapWaGqHopboaYua1qije67GJ6CuJAAAIfkEBQUABAAsCgACAFcAMAAAA/9Iutz+ML5Ag7w46z0r5WAoSp43nihXVmnrdusrv+s332dt4Tyo9yOBUJD6oQBIQGs4RBlHySSKyczVTtHoidocPUNZaZAr9F5FYbGI3PWdQWn1mi36buLKFJvojsHjLnshdhl4L4IqbxqGh4gahBJ4eY1kiX6LgDN7fBmQEJI4jhieD4yhdJ2KkZk8oiSqEaatqBekDLKztBG2CqBACq4wJRi4PZu1sA2+v8C6EJexrBAD1AOBzsLE0g/V1UvYR9sN3eR6lTLi4+TlY1wz6Qzr8u1t6FkY8vNzZTxaGfn6mAkEGFDgL4LrDDJDyE4hEIbdHB6ESE1iD4oVLfLAqPETIsOODwmCDJlv5MSGJklaS6khAQAh+QQFBQAEACwfAAIAVwAwAAAD/0i63P5LSAGrvTjrNuf+YKh1nWieIumhbFupkivPBEzR+GnnfLj3ooFwwPqdAshAazhEGUXJJIrJ1MGOUamJ2jQ9QVltkCv0XqFh5IncBX01afGYnDqD40u2z76JK/N0bnxweC5sRB9vF34zh4gjg4uMjXobihWTlJUZlw9+fzSHlpGYhTminKSepqebF50NmTyor6qxrLO0L7YLn0ALuhCwCrJAjrUqkrjGrsIkGMW/BMEPJcphLgDaABjUKNEh29vdgTLLIOLpF80s5xrp8ORVONgi8PcZ8zlRJvf40tL8/QPYQ+BAgjgMxkPIQ6E6hgkdjoNIQ+JEijMsasNY0RQix4gKP+YIKXKkwJIFF6JMudFEAgAh+QQFBQAEACw8AAIAQgBCAAAD/kg0PPowykmrna3dzXvNmSeOFqiRaGoyaTuujitv8Gx/661HtSv8gt2jlwIChYtc0XjcEUnMpu4pikpv1I71astytkGh9wJGJk3QrXlcKa+VWjeSPZHP4Rtw+I2OW81DeBZ2fCB+UYCBfWRqiQp0CnqOj4J1jZOQkpOUIYx/m4oxg5cuAaYBO4Qop6c6pKusrDevIrG2rkwptrupXB67vKAbwMHCFcTFxhLIt8oUzLHOE9Cy0hHUrdbX2KjaENzey9Dh08jkz8Tnx83q66bt8PHy8/T19vf4+fr6AP3+/wADAjQmsKDBf6AOKjS4aaHDgZMeSgTQcKLDhBYPEswoA1BBAgAh+QQFBQAEACxOAAoAMABXAAAD7Ei6vPOjyUkrhdDqfXHm4OZ9YSmNpKmiqVqykbuysgvX5o2HcLxzup8oKLQQix0UcqhcVo5ORi+aHFEn02sDeuWqBGCBkbYLh5/NmnldxajX7LbPBK+PH7K6narfO/t+SIBwfINmUYaHf4lghYyOhlqJWgqDlAuAlwyBmpVnnaChoqOkpaanqKmqKgGtrq+wsbA1srW2ry63urasu764Jr/CAb3Du7nGt7TJsqvOz9DR0tPU1TIA2ACl2dyi3N/aneDf4uPklObj6OngWuzt7u/d8fLY9PXr9eFX+vv8+PnYlUsXiqC3c6PmUUgAACH5BAUFAAQALE4AHwAwAFcAAAPpSLrc/m7IAau9bU7MO9GgJ0ZgOI5leoqpumKt+1axPJO1dtO5vuM9yi8TlAyBvSMxqES2mo8cFFKb8kzWqzDL7Xq/4LB4TC6bz1yBes1uu9uzt3zOXtHv8xN+Dx/x/wJ6gHt2g3Rxhm9oi4yNjo+QkZKTCgGWAWaXmmOanZhgnp2goaJdpKGmp55cqqusrZuvsJays6mzn1m4uRAAvgAvuBW/v8GwvcTFxqfIycA3zA/OytCl0tPPO7HD2GLYvt7dYd/ZX99j5+Pi6tPh6+bvXuTuzujxXens9fr7YPn+7egRI9PPHrgpCQAAIfkEBQUABAAsPAA8AEIAQgAAA/lIutz+UI1Jq7026h2x/xUncmD5jehjrlnqSmz8vrE8u7V5z/m5/8CgcEgsGo/IpHLJbDqf0Kh0ShBYBdTXdZsdbb/Yrgb8FUfIYLMDTVYz2G13FV6Wz+lX+x0fdvPzdn9WeoJGAYcBN39EiIiKeEONjTt0kZKHQGyWl4mZdREAoQAcnJhBXBqioqSlT6qqG6WmTK+rsa1NtaGsuEu6o7yXubojsrTEIsa+yMm9SL8osp3PzM2cStDRykfZ2tfUtS/bRd3ewtzV5pLo4eLjQuUp70Hx8t9E9eqO5Oku5/ztdkxi90qPg3x2EMpR6IahGocPCxp8AGtigwQAIfkEBQUABAAsHwBOAFcAMAAAA/9Iutz+MMo36pg4682J/V0ojs1nXmSqSqe5vrDXunEdzq2ta3i+/5DeCUh0CGnF5BGULC4tTeUTFQVONYAs4CfoCkZPjFar83rBx8l4XDObSUL1Ott2d1U4yZwcs5/xSBB7dBMBhgEYfncrTBGDW4WHhomKUY+QEZKSE4qLRY8YmoeUfkmXoaKInJ2fgxmpqqulQKCvqRqsP7WooriVO7u8mhu5NacasMTFMMHCm8qzzM2RvdDRK9PUwxzLKdnaz9y/Kt8SyR3dIuXmtyHpHMcd5+jvWK4i8/TXHff47SLjQvQLkU+fG29rUhQ06IkEG4X/Rryp4mwUxSgLL/7IqFETB8eONT6ChCFy5ItqJomES6kgAQAh+QQFBQAEACwKAE4AVwAwAAAD/0i63A4QuEmrvTi3yLX/4MeNUmieITmibEuppCu3sDrfYG3jPKbHveDktxIaF8TOcZmMLI9NyBPanFKJp4A2IBx4B5lkdqvtfb8+HYpMxp3Pl1qLvXW/vWkli16/3dFxTi58ZRcChwIYf3hWBIRchoiHiotWj5AVkpIXi4xLjxiaiJR/T5ehoomcnZ+EGamqq6VGoK+pGqxCtaiiuJVBu7yaHrk4pxqwxMUzwcKbyrPMzZG90NGDrh/JH8t72dq3IN1jfCHb3L/e5ebh4ukmxyDn6O8g08jt7tf26ybz+m/W9GNXzUQ9fm1Q/APoSWAhhfkMAmpEbRhFKwsvCsmosRIHx444PoKcIXKkjIImjTzjkQAAIfkEBQUABAAsAgA8AEIAQgAAA/VIBNz+8KlJq72Yxs1d/uDVjVxogmQqnaylvkArT7A63/V47/m2/8CgcEgsGo/IpHLJbDqf0Kh0Sj0FroGqDMvVmrjgrDcTBo8v5fCZki6vCW33Oq4+0832O/at3+f7fICBdzsChgJGeoWHhkV0P4yMRG1BkYeOeECWl5hXQ5uNIAOjA1KgiKKko1CnqBmqqk+nIbCkTq20taVNs7m1vKAnurtLvb6wTMbHsUq4wrrFwSzDzcrLtknW16tI2tvERt6pv0fi48jh5h/U6Zs77EXSN/BE8jP09ZFA+PmhP/xvJgAMSGBgQINvEK5ReIZhQ3QEMTBLAAAh+QQFBQAEACwCAB8AMABXAAAD50i6DA4syklre87qTbHn4OaNYSmNqKmiqVqyrcvBsazRpH3jmC7yD98OCBF2iEXjBKmsAJsWHDQKmw571l8my+16v+CweEwum8+hgHrNbrvbtrd8znbR73MVfg838f8BeoB7doN0cYZvaIuMjY6PkJGSk2gClgJml5pjmp2YYJ6dX6GeXaShWaeoVqqlU62ir7CXqbOWrLafsrNctjIDwAMWvC7BwRWtNsbGFKc+y8fNsTrQ0dK3QtXAYtrCYd3eYN3c49/a5NVj5eLn5u3s6e7x8NDo9fbL+Mzy9/T5+tvUzdN3Zp+GBAAh+QQJBQAEACwCAAIAfAB8AAAD/0i63P4wykmrvTjrzbv/YCiOZGmeaKqubOu+cCzPdArcQK2TOL7/nl4PSMwIfcUk5YhUOh3M5nNKiOaoWCuWqt1Ou16l9RpOgsvEMdocXbOZ7nQ7DjzTaeq7zq6P5fszfIASAYUBIYKDDoaGIImKC4ySH3OQEJKYHZWWi5iZG0ecEZ6eHEOio6SfqCaqpaytrpOwJLKztCO2jLi1uoW8Ir6/wCHCxMG2x7muysukzb230M6H09bX2Nna29zd3t/g4cAC5OXm5+jn3Ons7eba7vHt2fL16tj2+QL0+vXw/e7WAUwnrqDBgwgTKlzIsKHDh2gGSBwAccHEixAvaqTYcFCjRoYeNyoM6REhyZIHT4o0qPIjy5YTTcKUmHImx5cwE85cmJPnSYckK66sSAAj0aNIkypdyrSp06dQo0qdSrWq1atYs2rdyrWr169gwxZJAAA7')",backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"40px 40px"},b={position:"absolute",width:"100%",height:"100%",display:"none",background:"rgba(0,0,0,0.4)",backgroundImage:"url('data:image/png;base64,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')",backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"48px 48px",cursor:"pointer"},x={position:"absolute",top:0,height:"100%",display:"flex",alignItems:"center"},U={display:"none",position:"relative",fontSize:"13px",color:"#fff",lineHeight:"20px",marginLeft:"5px",marginRight:"5px"},O={display:"none",position:"relative",width:"16px",height:"16px",marginLeft:"8px",marginRight:"8px",backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"100%",cursor:"pointer"};return t(w,D),t(n,{height:"38px",zIndex:11,position:"absolute",left:0,bottom:0,width:"100%",background:"rgba(0,0,0)"}),t(p,R),t(c,b),t(m,{position:"absolute",width:"100%",top:"60%",textAlign:"center"}),t(o,Object.assign({},x,{left:0})),t(r,Object.assign({},x,{right:0})),t(a,U),t(s,U),t(d,Object.assign({},O,{backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQEAYAAABPYyMiAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAASAAAAEgARslrPgAAARVJREFUSMe9laEOglAUhs+5k9lJFpsJ5QWMJoNGbEY0mEy+gr6GNo0a3SiQCegMRILzGdw4hl+Cd27KxPuXb2zA/91z2YXoGRERkX4fvN3A2QxUiv4dFM3n8jZRBLbbVfd+ubJuF4xjiCyXkksueb1uSKCIZYGLBTEx8ekEoV7PkICeVgs8HiGyXoO2bUigCDM4HoPnM7bI8wwJ6Gk0sEXbLSay30Oo2TQkoGcwgFCSQMhxDAvoETEscDiQkJC4LjMz8+XyZ4HrFYWjEQqHQ1asWGWZfmdFAsVINxuw00HhbvfpydpvxWkKTqdYaRCUfUPJCdzv4Gr1uqfli0tOIAzByUT/iCrL6+84y3Bw+D6ui5Ou+jwA8FnIO++FACgAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjEtMDEtMDhUMTY6NDI6NTMrMDg6MDCKP7wnAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIxLTAxLTA4VDE2OjQyOjUzKzA4OjAw+2IEmwAAAEl0RVh0c3ZnOmJhc2UtdXJpAGZpbGU6Ly8vaG9tZS9hZG1pbi9pY29uLWZvbnQvdG1wL2ljb25fZ2Y3MDBzN2IzZncvYm9mYW5nLnN2Z8fICi0AAAAASUVORK5CYII=')"})),t(l,Object.assign({},O,{backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQEAYAAABPYyMiAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAASAAAAEgARslrPgAAAHVJREFUSMftkCESwCAMBEOnCtdXVMKHeC7oInkEeQJXkRoEZWraipxZc8lsQqQZBACAlIS1oqGhhTCdu3oyxyyMcdRf79c5J7SWDBky+z4173rbJvR+VF/e/qwKqIAKqMBDgZyFzAQCoZTpxq7HLDyOrw/9b07l3z4dDnI2IAAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMS0wMS0wOFQxNjo0Mjo1MyswODowMIo/vCcAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjEtMDEtMDhUMTY6NDI6NTMrMDg6MDD7YgSbAAAASnRFWHRzdmc6YmFzZS11cmkAZmlsZTovLy9ob21lL2FkbWluL2ljb24tZm9udC90bXAvaWNvbl9nZjcwMHM3YjNmdy96YW50aW5nLnN2ZxqNZJkAAAAASUVORK5CYII=')"})),t(h,Object.assign({},O,{backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQEAYAAABPYyMiAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAASAAAAEgARslrPgAAAaxJREFUSMfNlLFOAkEQhmevAZMjR6OGRBJKsFBzdkYNpYSaWkopIOFRCBWh1ieA+ALGRgutjK0HzV2H5SX7W/zsmY3cnTEhcZovOzcz9+/s7Ir8d4OGht7fBwAgjvEri2OTl1ffSf0xAMBxRIkS1e3Se3+vcszEMe/6OqmT/aN2m1wsNu/o5YVsNHI7BgA4PCRfXzfXCwKy1RLbcXZG9nrkzc12jvT8nPU/PtatOThgAx8fuS4WyZ0de2e+T87n5OcnuVqRsxl5cpImQDnKUc7DA1fVqpimZCu+vCSjiNH9PlmpJNTQ0INBErfeafZRAakC6FWKfH9nwU7H/l6rGdqCOx3y7c3U+aOARsMMp+1vNskwTLjulB23XJL1epqA9OshIiKeJxAIoug7UyA4OuLi6Ynr52deu+NjOy4MSc9Ln8rMDpTLybBpaOjdXbJUIqdTm8a/t2fn/RSQewR24HicTLmGhnbdzcPquvYtGY3+PIR24UKBUXd35v6Sk4lN47+9NXm/FBAEedfGTjw9JYdDm76fm6+hoS8ujGAxT6L9Im7bTKeurvIEb92+AES1b6x283XSAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIxLTAxLTA4VDE2OjQyOjUzKzA4OjAwij+8JwAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMS0wMS0wOFQxNjo0Mjo1MyswODowMPtiBJsAAABJdEVYdHN2ZzpiYXNlLXVyaQBmaWxlOi8vL2hvbWUvYWRtaW4vaWNvbi1mb250L3RtcC9pY29uX2dmNzAwczdiM2Z3L2NhbWVyYS5zdmeyubWEAAAAAElFTkSuQmCC')"})),t(u,Object.assign({},O,{backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQEAYAAABPYyMiAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAASAAAAEgARslrPgAAALZJREFUSMftVbsORUAQVSj8DomChvh3lU5CoSVCQq2RObeYu8XG3deVoHCak81kds7Oaz3vxRcAAMwztOg6vX9d6/3XFQQC+b7iAoFhYE7Tvx9EIFAcy/ftO3MQGAQkCfM4MmeZWyajiLnvmYuCeduMAuSzvRBVYNluFHCssSgFp7Sq9ALKkjnPf9ubRtkDL27HNT3QtsY9cAjsNAVheHIKBOwD2wpxFHDbJpwmaHH2L1iWx+2BDy8RbXXtqbRBAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIxLTAxLTA4VDE2OjQyOjUzKzA4OjAwij+8JwAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMS0wMS0wOFQxNjo0Mjo1MyswODowMPtiBJsAAABTdEVYdHN2ZzpiYXNlLXVyaQBmaWxlOi8vL2hvbWUvYWRtaW4vaWNvbi1mb250L3RtcC9pY29uX2dmNzAwczdiM2Z3L3F1YW5waW5nenVpZGFodWEuc3ZnTBoI7AAAAABJRU5ErkJggg==')"})),t(g,Object.assign({},O,{backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQEAYAAABPYyMiAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAASAAAAEgARslrPgAAAYJJREFUSMfdVbGKwkAQnQn+geAfWBixUTsVgp3YGKxSWflVNmIjARULwc5KO40ipNHWRgs/wGLniucKa+Jd5ODuuGle5u3szGRmd5bor4iIiMhuB3Sc+HXXBdp2/Lpta7v4dccRJUrUdhtNQIkSVa3C8HwG1uumg34f2OnEB+h0tF1Sv5b+YIsttpZLEhKSdhvscPi8IXFF74GJiYnHY7Cex8zMvFgkbInjmJnv98kqoO30vmhLtaRMB60WtEbDNDudgMUiKiQSzfjOMzFxoQAyCPSfw7/nQZ/PUYnpNGV6OR6BmYzJbzYIoBQCzGaRBDQvJCTdLnTLolg5HN5t6f8V1h/oUT4PrVKJWBotmEzQw+vV3J9Ow851P2/BaoX9Yfh0BrJZYKlk8uUyHOpDeLuBHwzMBJtN2PV6IPUhXK9Nf5cLMAxfluanrmGkRBggtRo03wfq66P/6CsJAnOg+f6rgfZI4BGYiYlHIx048eR6krcnq34kkj1GuVz8+jceo9+SD5A8yGh8CTq7AAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIxLTAxLTA4VDE2OjQyOjUzKzA4OjAwij+8JwAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMS0wMS0wOFQxNjo0Mjo1MyswODowMPtiBJsAAABNdEVYdHN2ZzpiYXNlLXVyaQBmaWxlOi8vL2hvbWUvYWRtaW4vaWNvbi1mb250L3RtcC9pY29uX2dmNzAwczdiM2Z3L3p1aXhpYW9odWEuc3ZnoCFr0AAAAABJRU5ErkJggg==')"})),t(f,Object.assign({},O,{backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQEAYAAABPYyMiAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAASAAAAEgARslrPgAAAR9JREFUSMfVlD0LglAYhe9VkwgNihpsjbYQf4JTS7+iuaGxpcGfJjS0NFRLk2NDi6MogafhJGRIX9yEzvJwrx/nvPd9VYh/F3LkyBuN2g3J1QoAgCQhPe/Hxq5Lo+0WlfJ9dYYAgGaTDAIyy/BUnwcwWJlhcLnZkN2ugIBAuy2kkEL2ep8F73S4kjfFcfn6cMj9KLodrWVBiXyf75tMyOOR+4MBOZ8XLXzorboA5UpnM/J0Ivd7+vX7xX2asqGpVKtFXi5sqWmypXefrfIWAACmU/JwKCoun8hu9zA0uk6u13wgirg+n7+bAcsibbt6SB3n9TQXPxwAwHJJpum7M6BcDDQa0SgMaw9QPkJNIxcLMo4ZcDz+eYDqQFLWbqxKV57EtW1WtMbmAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIxLTAxLTA4VDE2OjQyOjUzKzA4OjAwij+8JwAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMS0wMS0wOFQxNjo0Mjo1MyswODowMPtiBJsAAABKdEVYdHN2ZzpiYXNlLXVyaQBmaWxlOi8vL2hvbWUvYWRtaW4vaWNvbi1mb250L3RtcC9pY29uX2dmNzAwczdiM2Z3L2ppbmd5aW4uc3ZnIlMYaQAAAABJRU5ErkJggg==')"})),t(E,Object.assign({},O,{backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQEAYAAABPYyMiAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAASAAAAEgARslrPgAAAU5JREFUSMftkzGKwlAURf9PULBQwULSCKK1bZAgNuoaFFyAC3AdZg0uQCwshWzAShEEO7Gy0soUCu9Occ3An5nMGCfdzGsO7+Xy3/03iVL/lbAAACiVIBCI77O37Vi9QCDZbEqLm03ycEBUAoHk818v7nYpul5Jz4tf8HBKYa1mcjwmbzd8rG8NFIsU7ffk8UjmcjE3XK+RtB4G2PT75GbDeblMttumfjSKMRCGLxsQCKTReE9KIJDJxDw/SmKxiOZWWh+ntrSlre2WXRAorbTSrZapip7X66kbMKtQUFBQCENznsmQ93vqBhh5r8fO85jAcsnIrcce1yV3uxgD8zl5uZgU+dGBVlrp6GbTKRPwffaDAek45Gz2/M0AAJ0OeTol+w0rFYrOZ3K1MhNJEjEAwHF4cBA8Z8B1zcXV6msv+JMR2yaHQ1LrXx/8Z+sNRxsWcwZeb6UAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjEtMDEtMDhUMTY6NDI6NTMrMDg6MDCKP7wnAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIxLTAxLTA4VDE2OjQyOjUzKzA4OjAw+2IEmwAAAEt0RVh0c3ZnOmJhc2UtdXJpAGZpbGU6Ly8vaG9tZS9hZG1pbi9pY29uLWZvbnQvdG1wL2ljb25fZ2Y3MDBzN2IzZncvc2hlbmd5aW4uc3ZnFog1MQAAAABJRU5ErkJggg==')"})),t(v,Object.assign({},O,{backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQEAYAAABPYyMiAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAASAAAAEgARslrPgAAAPRJREFUSMflVDEOwjAQO0e8gr2sZYVunREbD6ISfAgmkBjpC/hBEQ+AtTWD6QAI0gBlqRfLp+TiXC5n1nXgMUCS5HBoNBqj6IOMMFwuEpsNAABl6d3HihWrOJaBsuRPkGW+c929HAxuYefb6L+R0ZgkMrJYiItCnCT1sl5Y1jwXj0bNniJNJWqujfX7LyrwJh8AYDxWgulU0dPp20IFlxoODm61kpE4VnS9/puBXyPYgH7LbKY3PhwUnUw+NdC4CdW9+71UgyZspwIBB9No3O0klktxUahyx+Pz+lYG0Xzu84lXRqTqwRQAGAzns8R223gUdxZXGcAK5Hp0ClIAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjEtMDEtMDhUMTY6NDI6NTMrMDg6MDCKP7wnAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIxLTAxLTA4VDE2OjQyOjUzKzA4OjAw+2IEmwAAAE50RVh0c3ZnOmJhc2UtdXJpAGZpbGU6Ly8vaG9tZS9hZG1pbi9pY29uLWZvbnQvdG1wL2ljb25fZ2Y3MDBzN2IzZncvbHV6aGlzaGlwaW4uc3Zn5Zd7GQAAAABJRU5ErkJggg==')"})),t(B,Object.assign({},O,{backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQEAYAAABPYyMiAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAASAAAAEgARslrPgAAAahJREFUSMdjYBjpgBFd4NZK+f+soQYG//T+yzFuUFUl2cApjEWM/758UZvysPDn3127GBkZGBgY/v4l6ICb9xTWsRbp6/9f9W8N44Jz5xgCGI4wfGFiIttrR/5n/3/U3KyR8rj8t0RdHS5lcAv+//yXzzhZTY1ii2FAmsGZocna+maD3GnWY62tNzbJBbDOffLkxie5eJYwa2uYMhaigzb2/zyGguPH/y9mTGKYYGlJUIMiYxDjHCen/4oMDAxznJzg4k8Z/jP+l5LCCAFCQP30Y5dfXVZWDI7/zzIs8PNjNGJ4/7/r+XNKA4rkoNZ4/lj0V9TmzUxJv0J+F+jrM3YyvPq/acsWujmA2oBkB9y4LifLxhoa+teAzYFtwtWr/8sZxBj9fHxo7oCbprJ72MqOHWNgZGBkYFy1isGGoZahTFSU0hAgOhcQnfph4P7/df9T9u1jPMn4nyHmxIn/bAzLGe7GxTHsZyj+f+zpUwYGBmmG6bQsiMr+L/v/rqlJY9Njm9889fW4lGEUxXCHwAomUgH3vxBG8c+f1WWf9P98sns3oaJ4FAAAbtWqHTT84QYAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjEtMDEtMDhUMTY6MzU6MjMrMDg6MDBLHbvEAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIxLTAxLTA4VDE2OjM1OjIzKzA4OjAwOkADeAAAAE50RVh0c3ZnOmJhc2UtdXJpAGZpbGU6Ly8vaG9tZS9hZG1pbi9pY29uLWZvbnQvdG1wL2ljb25fcTM1YTFhNHBtY2MvbHV6aGlzaGlwaW4uc3Zn6xlv1QAAAABJRU5ErkJggg==')"})),p.appendChild(m),o.appendChild(a),o.appendChild(s),r.appendChild(B),r.appendChild(v),r.appendChild(h),r.appendChild(d),r.appendChild(l),r.appendChild(E),r.appendChild(f),r.appendChild(u),r.appendChild(g),n.appendChild(o),n.appendChild(r),i.appendChild(w),i.appendChild(p),i.appendChild(n),i.appendChild(c),A.appendChild(i),{textDom:a,speedDom:s,playDom:d,pauseDom:l,loadingDom:p,screenshotsDom:h,fullscreenDom:u,minScreenDom:g,playAudioDom:E,quietAudioDom:f,recordDom:v,recordingDom:B,bgDom:w,playBigDom:c}}(this.container,A),this._initStatus(),this._initEventListener(),this._hideBtns()}function e(){}function t(){var A=document.fullscreenElement||window.webkitFullscreenElement||document.msFullscreenElement;return void 0===A&&(A=!1),!!A}function i(){o="",a&&(clearTimeout(a),a=null)}function n(A,e){A&&(A.style.display=e?"block":"none")}A.prototype._initEventListener=function(){var A=this;this.doms.playDom.addEventListener("click",function(e){e.stopPropagation(),A.play(),A.playing=!0},!1),this.doms.playBigDom.addEventListener("click",function(e){e.stopPropagation(),A.play(),A.playing=!0},!1),this.doms.pauseDom.addEventListener("click",function(e){e.stopPropagation(),A.pause(),A.playing=!1},!1),this.doms.screenshotsDom.addEventListener("click",function(e){e.stopPropagation();!function(A,e){const t=document.createElement("a");t.download=e+""+(new Date).getTime(),t.href=URL.createObjectURL(A),t.click(),URL.revokeObjectURL(A)}(function(A){const e=A.split(","),t=atob(e[1]),i=e[0].replace("data:","").replace(";base64","");let n=t.length,o=new Uint8Array(n);for(;n--;)o[n]=t.charCodeAt(n);return new File([o],"file",{type:i})}(A.canvasElement.toDataURL("image/png")),A.text)},!1),this.doms.fullscreenDom.addEventListener("click",function(e){e.stopPropagation(),A.fullscreen=!0},!1),this.doms.minScreenDom.addEventListener("click",function(e){e.stopPropagation(),A.fullscreen=!1},!1),this.doms.recordDom.addEventListener("click",function(e){e.stopPropagation(),A.onRecord(!0),A.recording=!0},!1),this.doms.recordingDom.addEventListener("click",function(e){e.stopPropagation(),A.onRecord(!1),A.recording=!1},!1),this.doms.quietAudioDom.addEventListener("click",function(e){e.stopPropagation(),A.audioEnabled(!0),A.quieting=!1},!1),this.doms.playAudioDom.addEventListener("click",function(e){e.stopPropagation(),A.audioEnabled(!1),A.quieting=!0},!1)},A.prototype._initStatus=function(){this.recording=!1,this.playing=!1,this.quieting=!0,this.fullscreen=!1},A.prototype._initBtns=function(){n(this.doms.pauseDom,!0),n(this.doms.screenshotsDom,!0),n(this.doms.fullscreenDom,!0),n(this.doms.quietAudioDom,!0),n(this.doms.textDom,!0),n(this.doms.speedDom,!0),n(this.doms.recordDom,!0),n(this.doms.loadingDom,!1),n(this.doms.playDom,!1),n(this.doms.playBigDom,!1)},A.prototype._hideBtns=function(){var A=this;Object.keys(this.doms).forEach(function(e){n(A.doms[e],!1)})};var o="",r=0;A.prototype._updateBPS=function(A){o||(o=(new Date).getTime());var e=(new Date).getTime();e-o<1e3?r+=A:(this.doms.speedDom.innerText=function(A){if(null==A||""==A)return"0 KB/S";var e=parseFloat(A)/1024;return(e=e.toFixed(2))+"KB/S"}(r),r=0,o=e)};var a=null;A.prototype._checkHeart=function(){a&&(clearTimeout(a),a=null);var A=this;a=setTimeout(function(){console.log("check heart break"),A.playing=!1},3e3)},A.prototype.initAudioPlanar=function(A){var e=A.channels,t=A.samplerate;console.log("initAudioPlanar:","channles:",e,"samplerate:",t);var i=this.audioContext,n=!1,o=[];if(!i)return!1;var r=this;this.playAudio=function(A){var a=A[0][0].length,s=i.createBuffer(e,a*A.length,t),d=function(t){if(t)if(n)o.push(t);else{n=!0,function(t){for(var i=0;i<e;i++)for(var n=s.getChannelData(i),o=0;o<A.length;o++)for(var r=0;r<a;r++)n[r+o*a]=t[o][i][r]}(t);var r=i.createBufferSource();r.buffer=s,r.connect(i.destination),r.start()}};r.playAudio=d,r.audioInterval=setInterval(function(){n=!1,o.length&&d(o.shift())},1e3*s.duration),d(A)}},A.prototype.audioEnabled=function(A){A?(!function(A){A.resume();var e=A.createBufferSource();e.buffer=A.createBuffer(1,1,22050),e.connect(A.destination),e.noteOn?e.noteOn(0):e.start(0)}(this.audioContext),this.audioEnabled=function(A){A?this.audioContext.resume():this.audioContext.suspend()}):this.audioContext.suspend()},A.prototype.playAudio=function(A){var e=this.audioContext,t=!1,i=!1;if(!e)return!1;var n=[],o=[],r=this,a=function(A){n.length&&s(n.shift())},s=function(A){t=!0;var i=e.createBufferSource();i.buffer=A,i.connect(e.destination),i.start(),r.audioInterval||(r.audioInterval=setInterval(a,1e3*A.duration-1))},d=function(){o.length?e.decodeAudioData(o.shift(),c,d):i=!1},c=function(A){d(),t?n.push(A):s(A)},l=function(A){o.push(...A),i||(i=!0,d())};this.playAudio=l,l(A)},A.prototype.initAudioPlay=function(A,e,t){var i=this.audioContext,n=!1,o=[];if(!i)return!1;var r=this,a=e<22050;a&&console.log("resampled!");var s=a?i.createBuffer(t,A<<1,e<<1):i.createBuffer(t,A,e),d=function(){n=!1,o.length&&l(o.shift())},c=t>1?function(e){for(var i=0;i<t;i++){var n=s.getChannelData(i);if(a)for(o=0;o<A;o++)n[2*o]=n[2*o+1]=e[o*(i+1)]/32768;else for(var o=0;o<A;o++)n[o]=e[o*(i+1)]/32768}}:function(A){for(var e=s.getChannelData(0),t=0;t<e.length;t++)e[t]=A[t]/32768},l=function(A){if(n)o.push(A);else{n=!0,c(A);var e=i.createBufferSource();e.buffer=s,e.connect(i.destination),r.audioInterval||(r.audioInterval=setInterval(d,1e3*s.duration)),e.start()}};this.playAudio=l},A.prototype.isWebGL=function(){return!!this.contextGL},A.prototype.initContextGL=function(){for(var A=this.canvasElement,e=null,t=["webgl","experimental-webgl","moz-webgl","webkit-3d"],i=0;!e&&i<t.length;){var n=t[i];try{var o={preserveDrawingBuffer:!0};this.contextOptions&&(o=Object.assign(o,this.contextOptions)),e=A.getContext(n,o)}catch(A){e=null}e&&"function"==typeof e.getParameter||(e=null),++i}this.contextGL=e},A.prototype.initProgram=function(){var A=this.contextGL,e=["attribute vec4 vertexPos;","attribute vec4 texturePos;","varying vec2 textureCoord;","void main()","{","gl_Position = vertexPos;","textureCoord = texturePos.xy;","}"].join("\n"),t=["precision highp float;","varying highp vec2 textureCoord;","uniform sampler2D ySampler;","uniform sampler2D uSampler;","uniform sampler2D vSampler;","const mat4 YUV2RGB = mat4","(","1.1643828125, 0, 1.59602734375, -.87078515625,","1.1643828125, -.39176171875, -.81296875, .52959375,","1.1643828125, 2.017234375, 0, -1.081390625,","0, 0, 0, 1",");","void main(void) {","highp float y = texture2D(ySampler,  textureCoord).r;","highp float u = texture2D(uSampler,  textureCoord).r;","highp float v = texture2D(vSampler,  textureCoord).r;","gl_FragColor = vec4(y, u, v, 1) * YUV2RGB;","}"].join("\n"),i=A.createShader(A.VERTEX_SHADER);A.shaderSource(i,e),A.compileShader(i),A.getShaderParameter(i,A.COMPILE_STATUS)||console.log("Vertex shader failed to compile: "+A.getShaderInfoLog(i));var n=A.createShader(A.FRAGMENT_SHADER);A.shaderSource(n,t),A.compileShader(n),A.getShaderParameter(n,A.COMPILE_STATUS)||console.log("Fragment shader failed to compile: "+A.getShaderInfoLog(n));var o=A.createProgram();A.attachShader(o,i),A.attachShader(o,n),A.linkProgram(o),A.getProgramParameter(o,A.LINK_STATUS)||console.log("Program failed to compile: "+A.getProgramInfoLog(o)),A.useProgram(o),this.shaderProgram=o},A.prototype.initBuffers=function(){var A=this.contextGL,e=this.shaderProgram,t=A.createBuffer();A.bindBuffer(A.ARRAY_BUFFER,t),A.bufferData(A.ARRAY_BUFFER,new Float32Array([1,1,-1,1,1,-1,-1,-1]),A.STATIC_DRAW);var i=A.getAttribLocation(e,"vertexPos");A.enableVertexAttribArray(i),A.vertexAttribPointer(i,2,A.FLOAT,!1,0,0);var n=A.createBuffer();A.bindBuffer(A.ARRAY_BUFFER,n),A.bufferData(A.ARRAY_BUFFER,new Float32Array([1,0,0,0,1,1,0,1]),A.STATIC_DRAW);var o=A.getAttribLocation(e,"texturePos");A.enableVertexAttribArray(o),A.vertexAttribPointer(o,2,A.FLOAT,!1,0,0),this.texturePosBuffer=n},A.prototype.initTextures=function(){var A=this.contextGL,e=this.shaderProgram,t=this.initTexture(),i=A.getUniformLocation(e,"ySampler");A.uniform1i(i,0),this.yTextureRef=t;var n=this.initTexture(),o=A.getUniformLocation(e,"uSampler");A.uniform1i(o,1),this.uTextureRef=n;var r=this.initTexture(),a=A.getUniformLocation(e,"vSampler");A.uniform1i(a,2),this.vTextureRef=r},A.prototype.initTexture=function(){var A=this.contextGL,e=A.createTexture();return A.bindTexture(A.TEXTURE_2D,e),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_MAG_FILTER,A.LINEAR),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_MIN_FILTER,A.LINEAR),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_WRAP_S,A.CLAMP_TO_EDGE),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_WRAP_T,A.CLAMP_TO_EDGE),A.bindTexture(A.TEXTURE_2D,null),e},A.prototype.drawNextOutputPicture=function(A){this.contextGL?this.drawNextOuptutPictureGL(A):this.drawNextOuptutPictureRGBA(A)},A.prototype.drawNextOuptutPictureGL=function(A){var e=this.contextGL,t=this.texturePosBuffer,i=this.yTextureRef,n=this.uTextureRef,o=this.vTextureRef,r=this.croppingParams,a=this.canvasElement.width,s=this.canvasElement.height;if(r){e.viewport(0,0,r.width,r.height);var d=r.top/s,c=r.left/a,l=r.height/s,h=r.width/a,u=new Float32Array([h,d,c,d,h,l,c,l]);e.bindBuffer(e.ARRAY_BUFFER,t),e.bufferData(e.ARRAY_BUFFER,u,e.DYNAMIC_DRAW)}else e.viewport(0,0,this.canvasElement.width,this.canvasElement.height);e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,i),e.texImage2D(e.TEXTURE_2D,0,e.LUMINANCE,a,s,0,e.LUMINANCE,e.UNSIGNED_BYTE,A[0]),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,e.LUMINANCE,a/2,s/2,0,e.LUMINANCE,e.UNSIGNED_BYTE,A[1]),e.activeTexture(e.TEXTURE2),e.bindTexture(e.TEXTURE_2D,o),e.texImage2D(e.TEXTURE_2D,0,e.LUMINANCE,a/2,s/2,0,e.LUMINANCE,e.UNSIGNED_BYTE,A[2]),e.drawArrays(e.TRIANGLE_STRIP,0,4)},A.prototype.drawNextOuptutPictureRGBA=function(A){this.imageData.data.set(A);var e=this.croppingParams;e?this.ctx2d.putImageData(this.imageData,-e.left,-e.top,0,0,e.width,e.height):this.ctx2d.putImageData(this.imageData,0,0)},A.prototype.ctx2d=null,A.prototype.imageData=null,A.prototype.initRGB=function(A,e){this.ctx2d=this.canvasElement.getContext("2d"),this.imageData=this.ctx2d.getImageData(0,0,A,e),this.clear=function(){this.ctx2d.clearRect(0,0,A,e)}},A.prototype.pause=function(){this.close(),this.onPause()},A.prototype.close=function(){this.audioInterval&&clearInterval(this.audioInterval),delete this.playAudio,this.decoderWorker.postMessage({cmd:"close"}),i()},A.prototype.destroy=function(){this.decoderWorker.terminate(),window.removeEventListener("resize",this.onresize),window.removeEventListener("fullscreenchange",this.onfullscreenchange),i()},A.prototype.play=function(A){var e=!1;if(A?(this.playUrl&&(this.close(),e=!0,this.contextGL.clear(this.contextGL.COLOR_BUFFER_BIT)),this.loading=!0,this.playUrl=A):this.playUrl&&(A=this.playUrl,this.onPlay()),i(),e){var t=this;setTimeout(function(){t.decoderWorker.postMessage({cmd:"play",url:A,isWebGL:t.isWebGL()})},300)}else this.decoderWorker.postMessage({cmd:"play",url:A,isWebGL:this.isWebGL()})},Object.defineProperty(A.prototype,"fullscreen",{set(A){A?(t(),n(this.doms.minScreenDom,!0),n(this.doms.fullscreenDom,!1)):(t(),n(this.doms.minScreenDom,!1),n(this.doms.fullscreenDom,!0)),this._isFullscreen!==A&&this.onFullscreen(A),this._isFullscreen=A},get(){return this._isFullscreen}}),Object.defineProperty(A.prototype,"playing",{set(A){A?(n(this.doms.playBigDom,!1),n(this.doms.playDom,!1),n(this.doms.pauseDom,!0)):(this.doms.speedDom.innerText="",n(this.doms.playDom,!0),n(this.doms.playBigDom,!0),n(this.doms.pauseDom,!1)),this._playing=A},get(){return this._playing}}),Object.defineProperty(A.prototype,"recording",{set(A){A?(n(this.doms.recordDom,!1),n(this.doms.recordingDom,!0)):(n(this.doms.recordDom,!0),n(this.doms.recordingDom,!1)),this._recording=A},get(){return this._recording}}),Object.defineProperty(A.prototype,"quieting",{set(A){A?(n(this.doms.quietAudioDom,!0),n(this.doms.playAudioDom,!1)):(n(this.doms.quietAudioDom,!1),n(this.doms.playAudioDom,!0)),this._quieting=A},get(){return this._quieting}}),Object.defineProperty(A.prototype,"loading",{set(A){A?(this._hideBtns(),n(this.doms.loadingDom,!0)):this._initBtns(),this._loading=A},get(){return this._loading}}),A.prototype.resize=function(){this.width=this.container.clientWidth,this.height=this.container.clientHeight-38;var A=this.canvasElement.width,e=this.canvasElement.height,t=this.width/A,i=this.height/e,n=t>i?i:t;this.isResize||t!==i&&(n=t+","+i),console.log("wScale",t,"hScale",i),this.canvasElement.style.transform="scale("+n+")",this.canvasElement.style.left=(this.width-A)/2+"px",this.canvasElement.style.top=(this.height-e)/2+"px"},A.prototype.fullscreenchange=function(){this.fullscreen=t()},A.prototype.changeBuffer=function(A){this.decoderWorker.postMessage({cmd:"setVideoBuffer",time:Number(A)})},"function"==typeof define?define(function(){return A}):"undefined"!=typeof exports?module.exports=A:window.Jessibuca=A}();